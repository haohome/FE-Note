title: 你不知道的JavaScript之词法作用域与动态作用域
categories: JavaScript
date: 2018-10-20
tags: [YDKJS,JS]

------

## 介绍

在写代码的过程中,我们经常分不清作用域中变量的值指向什么,主要原因是我们分不清楚是应该按照函数的调用顺序还是按照函数位置的嵌套顺序查找变量.作用域有两种工作模式:词法作用域和动态作用域,词法作用域也叫静态作用域.

> - 词法作用域关心函数在**何处声明**，作用域链基于作用域嵌套 
> - 动态作用域关心函数在**何处调用**，作用域链基于调用栈

<!-- more -->

## 词法作用域

[词法作用域是定义在词法阶段的作用域，是由写代码时将变量和块作用域写在哪里来决定的，因此当词法分析器处理代码时会保持作用域不变](https://www.cnblogs.com/xiaohuochai/p/5700095.html).

无论函数在哪里被调用，也无论它如何被调用，它的词法作用域都只由函数被声明时所处的位置决定

```JavaScript
function foo(){
    var a = 1;
    bar();
}
function bar(){
    console.log(a);
}
var a = 100;
foo();  // 100
```

因为bar函数是在全局声明的，所以是输出全局变量a的值

词法作用域中又分为函数作用域和块级作用域,JavaScript没有动态作用域,它是基于函数作用域的,但同时也有块级作用域,如with关键字、try-catch语句的catch子句、let关键字（ES6）、const关键字（ES6）

## 动态作用域

我们经常会把词法作用域和this机制弄混淆,这是因为this机制从某种程度上与动态作用域类似.

动态作用域并不关心函数和作用域是如何声明以及在任何处声明的，只关心它们从何处调用

继续拿上面的例子,如果处于动态作用域,变量a应首先在bar()中查找,没有找到会顺着调用栈在调用bar()函数的地方也就是foo()函数中查找,找到赋值a为1,所以输出1

> 两种作用域的区别，简而言之，词法作用域是在定义时确定的，而动态作用域是在运行时确定的

